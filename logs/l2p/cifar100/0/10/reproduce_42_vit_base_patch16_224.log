2023-08-07 22:00:47,088 [trainer.py] => config: ./exps/l2p.json
2023-08-07 22:00:47,088 [trainer.py] => prefix: reproduce
2023-08-07 22:00:47,088 [trainer.py] => dataset: cifar100
2023-08-07 22:00:47,088 [trainer.py] => memory_size: 2000
2023-08-07 22:00:47,088 [trainer.py] => memory_per_class: 20
2023-08-07 22:00:47,088 [trainer.py] => fixed_memory: False
2023-08-07 22:00:47,088 [trainer.py] => shuffle: True
2023-08-07 22:00:47,088 [trainer.py] => init_cls: 10
2023-08-07 22:00:47,088 [trainer.py] => increment: 10
2023-08-07 22:00:47,088 [trainer.py] => model_name: l2p
2023-08-07 22:00:47,088 [trainer.py] => convnet_type: vit_base_patch16_224
2023-08-07 22:00:47,088 [trainer.py] => device: [device(type='cuda', index=3)]
2023-08-07 22:00:47,088 [trainer.py] => seed: 42
2023-08-07 22:00:48,047 [data_manager.py] => [83, 53, 70, 45, 44, 39, 22, 80, 10, 0, 18, 30, 73, 33, 90, 4, 76, 77, 12, 31, 55, 88, 26, 42, 69, 15, 40, 96, 9, 72, 11, 47, 85, 28, 93, 5, 66, 65, 35, 16, 49, 34, 7, 95, 27, 19, 81, 25, 62, 13, 24, 3, 17, 38, 8, 78, 6, 64, 36, 89, 56, 99, 54, 43, 50, 67, 46, 68, 61, 97, 79, 41, 58, 48, 98, 57, 75, 32, 94, 59, 63, 84, 37, 29, 1, 52, 21, 2, 23, 87, 91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
2023-08-07 22:00:48,372 [l2p.py] => L2P original args:Namespace(aa=None, batch_size=8, batchwise_prompt=True, clip_grad=1.0, color_jitter=None, config=None, cooldown_epochs=10, data_path='./local_datasets/', dataset='Split-CIFAR100', decay_epochs=30, decay_rate=0.1, device='cpu', dist_url='env://', drop=0.0, drop_path=0.0, embedding_key='cls', epochs=10, eval=False, freeze=['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed'], global_pool='token', head_type='token', initializer='uniform', input_size=224, length=5, lr=0.03, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, min_lr=1e-05, model='vit_base_patch16_224', momentum=0.9, nb_classes=100, num_tasks=10, num_workers=4, opt='adam', opt_betas=(0.9, 0.999), opt_eps=1e-08, output_dir='./output', patience_epochs=10, pin_mem=True, predefined_key='', pretrained=True, print_freq=10, prompt_key=True, prompt_key_init='uniform', prompt_pool=True, pull_constraint=True, pull_constraint_coeff=0.1, recount=1, reinit_optimizer=True, remode='pixel', reprob=0.0, sched='constant', seed=42, shared_prompt_key=False, shared_prompt_pool=False, shuffle=False, size=10, smoothing=0.1, task_inc=False, top_k=5, train_interpolation='bicubic', train_mask=True, unscale_lr=True, use_prompt_mask=False, warmup_epochs=5, warmup_lr=1e-06, weight_decay=0.0, world_size=1)
2023-08-07 22:00:50,729 [vision_transformer.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2023-08-07 22:00:50,729 [vision_transformer.py] => Position embedding grid-size from [14, 14] to (14, 14)
2023-08-07 22:00:51,047 [trainer.py] => All params: 171816392
2023-08-07 22:00:51,047 [trainer.py] => Trainable params: 122980
2023-08-07 22:00:51,048 [l2p.py] => Learning on 0-10
2023-08-07 22:06:27,908 [l2p.py] => Task 0, Epoch 5/5 => Loss 0.000, Train_accy 88.68
2023-08-07 22:06:38,029 [trainer.py] => No NME accuracy.
2023-08-07 22:06:38,030 [trainer.py] => CNN: {'total': 94.6, '00-09': 94.6, 'old': 0, 'new': 94.6}
2023-08-07 22:06:38,030 [trainer.py] => CNN top1 curve: [94.6]
2023-08-07 22:06:38,030 [trainer.py] => CNN top5 curve: [100.0]

2023-08-07 22:06:38,030 [trainer.py] => Average Accuracy (CNN): 94.6
2023-08-07 22:06:38,033 [trainer.py] => All params: 171816392
2023-08-07 22:06:38,035 [trainer.py] => Trainable params: 122980
2023-08-07 22:06:38,035 [l2p.py] => Learning on 10-20
2023-08-07 22:13:24,135 [l2p.py] => Task 1, Epoch 5/5 => Loss 0.272, Train_accy 83.82
2023-08-07 22:13:43,896 [trainer.py] => No NME accuracy.
2023-08-07 22:13:43,896 [trainer.py] => CNN: {'total': 93.0, '00-09': 94.3, '10-19': 91.7, 'old': 94.3, 'new': 91.7}
2023-08-07 22:13:43,897 [trainer.py] => CNN top1 curve: [94.6, 93.0]
2023-08-07 22:13:43,897 [trainer.py] => CNN top5 curve: [100.0, 99.35]

2023-08-07 22:13:43,897 [trainer.py] => Average Accuracy (CNN): 93.8
2023-08-07 22:13:43,899 [trainer.py] => All params: 171816392
2023-08-07 22:13:43,902 [trainer.py] => Trainable params: 122980
2023-08-07 22:13:43,902 [l2p.py] => Learning on 20-30
2023-08-07 22:20:42,163 [l2p.py] => Task 2, Epoch 5/5 => Loss 0.273, Train_accy 83.22
2023-08-07 22:21:12,756 [trainer.py] => No NME accuracy.
2023-08-07 22:21:12,757 [trainer.py] => CNN: {'total': 89.03, '00-09': 91.1, '10-19': 88.9, '20-29': 87.1, 'old': 90.0, 'new': 87.1}
2023-08-07 22:21:12,757 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03]
2023-08-07 22:21:12,757 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63]

2023-08-07 22:21:12,757 [trainer.py] => Average Accuracy (CNN): 92.21
2023-08-07 22:21:12,759 [trainer.py] => All params: 171816392
2023-08-07 22:21:12,762 [trainer.py] => Trainable params: 122980
2023-08-07 22:21:12,762 [l2p.py] => Learning on 30-40
2023-08-07 22:28:20,833 [l2p.py] => Task 3, Epoch 5/5 => Loss 0.188, Train_accy 85.18
2023-08-07 22:29:00,120 [trainer.py] => No NME accuracy.
2023-08-07 22:29:00,120 [trainer.py] => CNN: {'total': 86.4, '00-09': 87.0, '10-19': 84.6, '20-29': 84.0, '30-39': 90.0, 'old': 85.2, 'new': 90.0}
2023-08-07 22:29:00,121 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4]
2023-08-07 22:29:00,121 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18]

2023-08-07 22:29:00,121 [trainer.py] => Average Accuracy (CNN): 90.7575
2023-08-07 22:29:00,123 [trainer.py] => All params: 171816392
2023-08-07 22:29:00,125 [trainer.py] => Trainable params: 122980
2023-08-07 22:29:00,125 [l2p.py] => Learning on 40-50
2023-08-07 22:36:18,928 [l2p.py] => Task 4, Epoch 5/5 => Loss 0.103, Train_accy 88.84
2023-08-07 22:37:08,995 [trainer.py] => No NME accuracy.
2023-08-07 22:37:08,996 [trainer.py] => CNN: {'total': 84.86, '00-09': 85.7, '10-19': 83.3, '20-29': 82.2, '30-39': 88.6, '40-49': 84.5, 'old': 84.95, 'new': 84.5}
2023-08-07 22:37:08,996 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86]
2023-08-07 22:37:08,996 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9]

2023-08-07 22:37:08,996 [trainer.py] => Average Accuracy (CNN): 89.578
2023-08-07 22:37:08,999 [trainer.py] => All params: 171816392
2023-08-07 22:37:09,001 [trainer.py] => Trainable params: 122980
2023-08-07 22:37:09,001 [l2p.py] => Learning on 50-60
2023-08-07 22:44:36,687 [l2p.py] => Task 5, Epoch 5/5 => Loss 0.091, Train_accy 90.12
2023-08-07 22:45:37,665 [trainer.py] => No NME accuracy.
2023-08-07 22:45:37,665 [trainer.py] => CNN: {'total': 85.42, '00-09': 86.7, '10-19': 80.7, '20-29': 81.7, '30-39': 88.1, '40-49': 83.4, '50-59': 91.9, 'old': 84.12, 'new': 91.9}
2023-08-07 22:45:37,665 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86, 85.42]
2023-08-07 22:45:37,665 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9, 97.57]

2023-08-07 22:45:37,666 [trainer.py] => Average Accuracy (CNN): 88.88499999999999
2023-08-07 22:45:37,668 [trainer.py] => All params: 171816392
2023-08-07 22:45:37,670 [trainer.py] => Trainable params: 122980
2023-08-07 22:45:37,671 [l2p.py] => Learning on 60-70
2023-08-07 22:53:13,242 [l2p.py] => Task 6, Epoch 5/5 => Loss 0.056, Train_accy 91.24
2023-08-07 22:54:24,514 [trainer.py] => No NME accuracy.
2023-08-07 22:54:24,514 [trainer.py] => CNN: {'total': 84.26, '00-09': 83.3, '10-19': 78.7, '20-29': 80.8, '30-39': 83.3, '40-49': 82.3, '50-59': 89.7, '60-69': 91.7, 'old': 83.02, 'new': 91.7}
2023-08-07 22:54:24,515 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86, 85.42, 84.26]
2023-08-07 22:54:24,515 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9, 97.57, 97.46]

2023-08-07 22:54:24,515 [trainer.py] => Average Accuracy (CNN): 88.2242857142857
2023-08-07 22:54:24,517 [trainer.py] => All params: 171816392
2023-08-07 22:54:24,520 [trainer.py] => Trainable params: 122980
2023-08-07 22:54:24,520 [l2p.py] => Learning on 70-80
2023-08-07 23:02:07,583 [l2p.py] => Task 7, Epoch 5/5 => Loss 0.048, Train_accy 91.66
2023-08-07 23:03:28,715 [trainer.py] => No NME accuracy.
2023-08-07 23:03:28,715 [trainer.py] => CNN: {'total': 84.5, '00-09': 82.4, '10-19': 78.4, '20-29': 81.1, '30-39': 81.0, '40-49': 83.0, '50-59': 89.0, '60-69': 90.5, '70-79': 90.6, 'old': 83.63, 'new': 90.6}
2023-08-07 23:03:28,715 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86, 85.42, 84.26, 84.5]
2023-08-07 23:03:28,716 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9, 97.57, 97.46, 97.28]

2023-08-07 23:03:28,716 [trainer.py] => Average Accuracy (CNN): 87.75874999999999
2023-08-07 23:03:28,718 [trainer.py] => All params: 171816392
2023-08-07 23:03:28,720 [trainer.py] => Trainable params: 122980
2023-08-07 23:03:28,720 [l2p.py] => Learning on 80-90
2023-08-07 23:11:30,234 [l2p.py] => Task 8, Epoch 5/5 => Loss 0.063, Train_accy 90.82
2023-08-07 23:12:58,493 [trainer.py] => No NME accuracy.
2023-08-07 23:12:58,494 [trainer.py] => CNN: {'total': 83.21, '00-09': 81.0, '10-19': 78.7, '20-29': 78.6, '30-39': 76.9, '40-49': 82.6, '50-59': 89.1, '60-69': 89.6, '70-79': 89.8, '80-89': 82.6, 'old': 83.29, 'new': 82.6}
2023-08-07 23:12:58,494 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86, 85.42, 84.26, 84.5, 83.21]
2023-08-07 23:12:58,494 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9, 97.57, 97.46, 97.28, 97.1]

2023-08-07 23:12:58,494 [trainer.py] => Average Accuracy (CNN): 87.25333333333333
2023-08-07 23:12:58,495 [trainer.py] => All params: 171816392
2023-08-07 23:12:58,497 [trainer.py] => Trainable params: 122980
2023-08-07 23:12:58,497 [l2p.py] => Learning on 90-100
2023-08-07 23:21:08,318 [l2p.py] => Task 9, Epoch 5/5 => Loss 0.074, Train_accy 90.38
2023-08-07 23:22:45,856 [trainer.py] => No NME accuracy.
2023-08-07 23:22:45,857 [trainer.py] => CNN: {'total': 82.54, '00-09': 81.0, '10-19': 76.8, '20-29': 79.1, '30-39': 75.9, '40-49': 81.5, '50-59': 88.7, '60-69': 87.9, '70-79': 88.8, '80-89': 78.8, '90-99': 86.9, 'old': 82.06, 'new': 86.9}
2023-08-07 23:22:45,857 [trainer.py] => CNN top1 curve: [94.6, 93.0, 89.03, 86.4, 84.86, 85.42, 84.26, 84.5, 83.21, 82.54]
2023-08-07 23:22:45,857 [trainer.py] => CNN top5 curve: [100.0, 99.35, 98.63, 98.18, 97.9, 97.57, 97.46, 97.28, 97.1, 96.79]

2023-08-07 23:22:45,857 [trainer.py] => Average Accuracy (CNN): 86.782
